"use strict";(globalThis.webpackChunkdocdevtron=globalThis.webpackChunkdocdevtron||[]).push([[67709],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(96540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}},61456:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"user-guide/global-configurations/authorization/sso/keycloak","title":"Keycloak","description":"Prerequisites","source":"@site/docs/user-guide/global-configurations/authorization/sso/keycloak.md","sourceDirName":"user-guide/global-configurations/authorization/sso","slug":"/user-guide/global-configurations/authorization/sso/keycloak","permalink":"/docs/user-guide/global-configurations/authorization/sso/keycloak","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"OIDC","permalink":"/docs/user-guide/global-configurations/authorization/sso/oidc"},"next":{"title":"Okta","permalink":"/docs/user-guide/global-configurations/authorization/sso/okta"}}');var r=s(74848),t=s(28453);const o={},l="Keycloak",c={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Steps on Keycloak Admin Console",id:"steps-on-keycloak-admin-console",level:2},{value:"Creating a Client",id:"creating-a-client",level:3},{value:"Getting Client Secret",id:"getting-client-secret",level:3},{value:"Creating Users",id:"creating-users",level:3},{value:"Retrieving Issuer URL",id:"retrieving-issuer-url",level:3},{value:"Steps on Devtron",id:"steps-on-devtron",level:2},{value:"Configuring OIDC SSO",id:"configuring-oidc-sso",level:3},{value:"Adding Users",id:"adding-users",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"keycloak",children:"Keycloak"})}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Install and ",(0,r.jsx)(n.a,{href:"https://www.keycloak.org/guides#getting-started",children:"configure Keycloak"})," on your server or cloud environment."]}),"\n",(0,r.jsxs)(n.li,{children:["Create a new ",(0,r.jsx)(n.a,{href:"https://www.keycloak.org/getting-started/getting-started-kube#_create_a_realm",children:"realm in Keycloak"})," for your application."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"steps-on-keycloak-admin-console",children:"Steps on Keycloak Admin Console"}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-client",children:"Creating a Client"}),"\n",(0,r.jsx)(n.p,{children:"Here, we will add Devtron as a client for using Keycloak SSO."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the Admin Console, go to ",(0,r.jsx)(n.strong,{children:"Clients"})," and click ",(0,r.jsx)(n.strong,{children:"Create client"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/create-client.gif",alt:"Figure 1: Creating Client on Keycloak"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Within ",(0,r.jsx)(n.strong,{children:"General Settings"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Enter ",(0,r.jsx)(n.code,{children:"devtron"})," in the ",(0,r.jsx)(n.strong,{children:"Client ID"})," field. We will use this ID while configuring SSO later in Devtron."]}),"\n",(0,r.jsxs)(n.li,{children:["Enter ",(0,r.jsx)(n.code,{children:"Devtron"})," in the ",(0,r.jsx)(n.strong,{children:"Name"})," field."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/client-id.jpg",alt:"Figure 2: Client ID and Name"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Within ",(0,r.jsx)(n.strong,{children:"Capability config"}),", turn on ",(0,r.jsx)(n.strong,{children:"Client Authentication"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/enable-client-auth.gif",alt:"Figure 3: Enabling Client Authentication Toggle"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Within ",(0,r.jsx)(n.strong,{children:"Login settings"}),", enter ",(0,r.jsx)(n.code,{children:"https://<DEVTRON_BASE_URL>/orchestrator/api/dex/callback"})," in the following fields."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Valid redirect URIs"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Valid post logout redirect URIs"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Web origins"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/base-url.jpg",children:"Click here"})," to know where to find ",(0,r.jsx)(n.code,{children:"DEVTRON_BASE_URL"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/redirect-url.gif",alt:"Figure 4: Entering Callback/Redirect URIs"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"getting-client-secret",children:"Getting Client Secret"}),"\n",(0,r.jsx)(n.p,{children:"Here, we will obtain the secret we need while configuring SSO in Devtron."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to the ",(0,r.jsx)(n.strong,{children:"Credentials"})," tab of the client you created."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/client-secret.gif",alt:"Figure 5: Obtaining Client Secret"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Use the copy button next to the ",(0,r.jsx)(n.strong,{children:"Client Secret"})," field and paste it somewhere for future reference."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"creating-users",children:"Creating Users"}),"\n",(0,r.jsx)(n.p,{children:"Here, we will create a user that can log in to Devtron via SSO. We will assign a username and password that the user can enter while logging in to Devtron via Keycloak SSO."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the Admin Console, go to ",(0,r.jsx)(n.strong,{children:"Users"})," and click ",(0,r.jsx)(n.strong,{children:"Add user"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Give a username (e.g., ",(0,r.jsx)(n.em,{children:"usertest"}),") in the ",(0,r.jsx)(n.strong,{children:"Username"})," field and enter the user's email address (e.g., ",(0,r.jsx)(n.em,{children:(0,r.jsx)(n.a,{href:"mailto:usertest@example.com",children:"usertest@example.com"})}),") in the ",(0,r.jsx)(n.strong,{children:"Email"})," field."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/create-user.gif",alt:"Figure 6: Creating User Data"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Create"}),". Your user creation will be successful."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to the ",(0,r.jsx)(n.strong,{children:"Credentials"})," tab of the user you created."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/set-user-password.gif",alt:"Figure 7: Adding User Password"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Set password"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Enter the password and confirm it."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"retrieving-issuer-url",children:"Retrieving Issuer URL"}),"\n",(0,r.jsx)(n.p,{children:"Here, we will obtain the Issuer URL we need while configuring SSO in Devtron."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the Admin Console, go to ",(0,r.jsx)(n.strong,{children:"Realm settings"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.strong,{children:"General"})," tab, scroll down to the ",(0,r.jsx)(n.strong,{children:"Endpoints"})," field, and click the ",(0,r.jsx)(n.strong,{children:"OpenID Endpoint Configuration"})," link."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/endpoint-config.gif",alt:"Figure 8: OpenID Endpoint Configuration Link"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["This will open a new page, copy the value of the key named ",(0,r.jsx)(n.code,{children:"issuer"}),", and paste it somewhere for future reference."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/issuer-url.jpg",alt:"Figure 9: Locating Issuer URL"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"steps-on-devtron",children:"Steps on Devtron"}),"\n",(0,r.jsx)(n.h3,{id:"configuring-oidc-sso",children:"Configuring OIDC SSO"}),"\n",(0,r.jsx)(n.admonition,{title:"Who Can Perform This Action?",type:"caution",children:(0,r.jsx)(n.p,{children:"Users need to have super-admin permission to configure SSO."})}),"\n",(0,r.jsxs)(n.p,{children:["Here, we will set up an OIDC SSO and enter the values we obtained in the ",(0,r.jsx)(n.a,{href:"#steps-on-keycloak-admin-console",children:"previous section"}),"."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to ",(0,r.jsx)(n.strong,{children:"Global Configurations"})," \u2192 ",(0,r.jsx)(n.strong,{children:"SSO Login Services"})," \u2192 ",(0,r.jsx)(n.strong,{children:"OIDC"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/oidc.jpg",alt:"Figure 10: Choosing OIDC SSO"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Below the URL field, take the help of the ",(0,r.jsx)(n.strong,{children:"Click to use"})," option to populate the exact URL if the displayed one is incorrect."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/click-to-use.jpg",alt:"Figure 11: Populating Correct Orchestrator URL"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.strong,{children:"Configuration"})," editor, do the following:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["In the ",(0,r.jsx)(n.code,{children:"issuer"})," field, paste the URL you got while ",(0,r.jsx)(n.a,{href:"#retrieving-issuer-url",children:"retrieving issuer URL"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["In the ",(0,r.jsx)(n.code,{children:"clientID"})," field, paste the ID you entered while ",(0,r.jsx)(n.a,{href:"#creating-a-client",children:"creating the client"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["In the ",(0,r.jsx)(n.code,{children:"clientSecret"})," field, paste the secret you got under ",(0,r.jsx)(n.a,{href:"#getting-client-secret",children:"client credentials tab"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["In the ",(0,r.jsx)(n.code,{children:"redirectURI"})," field, make sure to enter the same redirect URI you gave in step 4 of ",(0,r.jsx)(n.a,{href:"#creating-a-client",children:"client creation"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/keycloak-sso-config.jpg",alt:"Figure 12: Sample Keycloak SSO Config"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"})," or ",(0,r.jsx)(n.strong,{children:"Update"})," to activate Keycloak SSO login."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"adding-users",children:"Adding Users"}),"\n",(0,r.jsx)(n.admonition,{title:"Who Can Perform This Action?",type:"caution",children:(0,r.jsx)(n.p,{children:"Users need to have super-admin permission to add users."})}),"\n",(0,r.jsx)(n.p,{children:"Here, we will add the user we created in the Keycloak Admin Console. If this step is skipped, the user might not be able to log in to Devtron via Keycloak."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to ",(0,r.jsx)(n.strong,{children:"Global Configurations"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Authorization"})," \u2192 ",(0,r.jsx)(n.strong,{children:"User Permissions"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"+ Add Users"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/add-user.jpg",alt:"Figure 13: Adding Users to Devtron"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In the ",(0,r.jsx)(n.strong,{children:"Email addresses"})," field, enter the email address of the user you created in Keycloak."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/add-email.jpg",alt:"Figure 14: Entering User Data and Permissions"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Assign necessary permissions to this new user. Refer ",(0,r.jsx)(n.a,{href:"/docs/user-guide/global-configurations/authorization/user-access",children:"user permissions"})," to know more."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Now, you may log out and test the Keycloak OIDC login method using the ",(0,r.jsx)(n.a,{href:"#creating-users",children:"user credentials"}),". Clicking the ",(0,r.jsx)(n.strong,{children:"Login with Oidc"})," button will land you on Keycloak's login page."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/login-oidc.jpg",alt:"Figure 15a: Login using OIDC method"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/global-configurations/sso-login-service/keycloak/keycloak-login.jpg",alt:"Figure 15b: Keycloak's Login Page"})}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"caution",children:(0,r.jsx)(n.p,{children:"Kindly get in touch with us if you encounter any issues while logging out of Keycloak on Devtron as it might be buggy."})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);