"use strict";(globalThis.webpackChunkdocdevtron=globalThis.webpackChunkdocdevtron||[]).push([[33875],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(96540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}},40108:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"user-guide/creating-application/app-metrics","title":"Application Metrics","description":"Introduction","source":"@site/docs/user-guide/creating-application/app-metrics.md","sourceDirName":"user-guide/creating-application","slug":"/user-guide/creating-application/app-metrics","permalink":"/docs/user-guide/creating-application/app-metrics","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Application Summary","permalink":"/docs/user-guide/app-details/application-summary"},"next":{"title":"Deployment Visibility & Actions","permalink":"/docs/user-guide/app-details/deployment-visibility"}}');var r=s(74848),i=s(28453);const a={},o="Application Metrics",l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Types of Metrics",id:"types-of-metrics",level:2},{value:"Set Up Application Metrics",id:"set-up-application-metrics",level:2},{value:"Step 1: Install Monitoring (Grafana) Integration",id:"step-1-install-monitoring-grafana-integration",level:3},{value:"For OSS and Self-Managed Enterprise",id:"for-oss-and-self-managed-enterprise",level:4},{value:"For Devtron-Managed Enterprise",id:"for-devtron-managed-enterprise",level:4},{value:"Step 2: Install Prometheus",id:"step-2-install-prometheus",level:3},{value:"Step 3: Set Up Prometheus Endpoint",id:"step-3-set-up-prometheus-endpoint",level:3},{value:"Step 4: Enable Application Metrics",id:"step-4-enable-application-metrics",level:3},{value:"Troubleshoot Issues",id:"troubleshoot-issues",level:2}];function c(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"application-metrics",children:"Application Metrics"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"Application Metrics are the indicators used to evaluate the performance and efficiency of your application. It can be enabled in the Devtron platform to see your application's metrics."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/app-metrics.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 1: Application Metrics"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"types-of-metrics",children:"Types of Metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Metrics"}),(0,r.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.strong,{children:"CPU usage"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Overall CPU utilization per pod and aggregated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.strong,{children:"Memory Usage"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Overall memory utilization per pod and aggregated"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.strong,{children:"Throughput"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Number of requests processed per minute"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"left"},children:(0,r.jsx)(n.strong,{children:"Latency"})}),(0,r.jsx)(n.td,{style:{textAlign:"left"},children:"Delay between request and response, measured in percentiles"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"set-up-application-metrics",children:"Set Up Application Metrics"}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"caution",children:(0,r.jsxs)(n.p,{children:["Application metrics can only be enabled if your application is deployed using Devtron Deployment Charts and not ",(0,r.jsx)(n.a,{href:"/docs/user-guide/app-management/configurations/deployment-charts",children:"Custom Deployment Charts"}),"."]})}),"\n",(0,r.jsx)(n.h3,{id:"step-1-install-monitoring-grafana-integration",children:"Step 1: Install Monitoring (Grafana) Integration"}),"\n",(0,r.jsx)(n.h4,{id:"for-oss-and-self-managed-enterprise",children:"For OSS and Self-Managed Enterprise"}),"\n",(0,r.jsx)(n.admonition,{title:"Who Can Perform This Action?",type:"caution",children:(0,r.jsx)(n.p,{children:"Only super admin users can install Devtron integrations."})}),"\n",(0,r.jsxs)(n.p,{children:["To use the Grafana dashboard, you need to first install the integration from the ",(0,r.jsx)(n.a,{href:"/docs/user-guide/integrations/",children:"Devtron Stack Manager"}),". Refer ",(0,r.jsx)(n.a,{href:"/docs/user-guide/integrations/grafana",children:"Monitoring (Grafana) Integration"})," to learn more."]}),"\n",(0,r.jsx)(n.h4,{id:"for-devtron-managed-enterprise",children:"For Devtron-Managed Enterprise"}),"\n",(0,r.jsxs)(n.p,{children:["If you want to enable Grafana Integration, email us at ",(0,r.jsx)(n.a,{href:"mailto:enterprise@devtron.ai",children:"enterprise@devtron.ai"})," or reach out to your Devtron representative."]}),"\n",(0,r.jsx)(n.h3,{id:"step-2-install-prometheus",children:"Step 2: Install Prometheus"}),"\n",(0,r.jsx)(n.admonition,{title:"Who Can Perform This Action?",type:"caution",children:(0,r.jsxs)(n.p,{children:["Users need to have ",(0,r.jsx)(n.a,{href:"/docs/user-guide/global-configurations/authorization/user-access#devtron-apps-permissions",children:"Admin role"})," or above to deploy a chart."]})}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"caution",children:(0,r.jsxs)(n.p,{children:["Ensure ",(0,r.jsx)(n.a,{href:"/docs/user-guide/app-management/configurations/gitops",children:"GitOps"})," is configured before deploying Prometheus. If not, Prometheus will default to being deployed via Helm."]})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to the ",(0,r.jsx)(n.strong,{children:"Chart Store"})," and search for ",(0,r.jsx)(n.code,{children:"prometheus"}),". Use the Prometheus community's ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," chart to deploy Prometheus."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/kube-prometheus-chart.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 2: Chart Store"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"After selecting the chart, configure these values as needed before deployment."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kube-state-metrics: \r\n    metricLabelsAllowlist:   \r\n    - pods=[*]\n"})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"serviceMonitorSelectorNilUsesHelmValues: false\r\npodMonitorSelectorNilUsesHelmValues: false\n"})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"Search for the above parameters, and update them as shown (or customize as needed)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/configure-chart.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 3a: Prometheus Chart Configuration"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/configure-chart-1.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 3b: Prometheus Chart Configuration (cont.)"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enable ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter to install CRDs:"]}),"\n",(0,r.jsxs)(n.p,{children:["Since Helm does not automatically apply CRDs, you need to enable the ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter in the Helm chart to ensure CRDs are applied before deploying Prometheus."]}),"\n",(0,r.jsxs)(n.p,{children:["In the Prometheus Helm chart settings, locate the ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter and set it to ",(0,r.jsx)(n.code,{children:"true"})," if it is ",(0,r.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/configure-chart-2.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 4: upgradeJob Parameter"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["After enabling the parameter, click ",(0,r.jsx)(n.strong,{children:"Deploy Chart"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{title:"Common Pitfall: Prometheus Deployment Timeout due to Failed CRDs",type:"caution",children:[(0,r.jsxs)(n.p,{children:["While deploying ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," chart, the deployment status may show as ",(0,r.jsx)(n.strong,{children:"Timed out"}),", and some CustomResourceDefinitions (CRDs) may appear as ",(0,r.jsx)(n.strong,{children:"Failed"}),"."]}),(0,r.jsxs)(n.p,{children:["To solve it, refer ",(0,r.jsx)(n.a,{href:"#troubleshoot-issues",children:"Troubleshoot Issues"})]})]}),"\n",(0,r.jsx)(n.h3,{id:"step-3-set-up-prometheus-endpoint",children:"Step 3: Set Up Prometheus Endpoint"}),"\n",(0,r.jsx)(n.admonition,{title:"Who Can Perform This Action?",type:"caution",children:(0,r.jsx)(n.p,{children:"Only super admin users can set up Prometheus endpoint in a cluster."})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Once Prometheus is installed, go to its ",(0,r.jsx)(n.strong,{children:"App Details"})," and navigate to ",(0,r.jsx)(n.strong,{children:"Networking"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Service"})," in the K8s resources. Expand the Prometheus server service to see the endpoints."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Copy the URL of the ",(0,r.jsx)(n.code,{children:"kube-prometheus"})," service as shown in the image below."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/endpoint.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 5: Prometheus Service"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To set Prometheus as a data source in Grafana, navigate to ",(0,r.jsx)(n.strong,{children:"Global Configurations"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Clusters & Environments"}),", select your cluster, and edit its settings."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/select-cluster.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 6: Clusters and Environments"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Now to set up the Prometheus endpoint:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Enable the ",(0,r.jsx)(n.code,{children:"See metrics for applications in this cluster"})," option, as shown in the image below."]}),"\n",(0,r.jsxs)(n.li,{children:["Paste the copied URL into the Prometheus endpoint field, ensuring it includes ",(0,r.jsx)(n.code,{children:"http://"})]}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Update Cluster"})," to save the changes."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/enable-app-metrics.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 7: Prometheus Endpoint"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-4-enable-application-metrics",children:"Step 4: Enable Application Metrics"}),"\n",(0,r.jsx)(n.admonition,{title:"Who Can Perform This Action?",type:"caution",children:(0,r.jsxs)(n.p,{children:["Users need to have ",(0,r.jsx)(n.a,{href:"/docs/user-guide/global-configurations/authorization/user-access#devtron-apps-permissions",children:"Admin role"})," or above to enable application metrics."]})}),"\n",(0,r.jsxs)(n.p,{children:["After adding the endpoint in your preferred cluster, ",(0,r.jsx)(n.strong,{children:"CPU usage"})," and ",(0,r.jsx)(n.strong,{children:"Memory usage"})," metrics will be visible in the ",(0,r.jsx)(n.strong,{children:"App Details"})," page for all the Devtron apps in that cluster (it may take a few minutes)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/cpu-memory.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 8: CPU Usage & Memory Usage"})]}),"\n",(0,r.jsxs)(n.p,{children:["To enable ",(0,r.jsx)(n.strong,{children:"Throughput"})," and ",(0,r.jsx)(n.strong,{children:"Latency"})," metrics in Devtron, follow these steps:"]}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"caution",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Throughput"})," and ",(0,r.jsx)(n.strong,{children:"Latency"})," metrics will only display data if there is active traffic (i.e., incoming requests) to your application. If there is no traffic, these metrics will show ",(0,r.jsx)(n.code,{children:"No data"}),"."]})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Open your Devtron app."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to its ",(0,r.jsx)(n.strong,{children:"Configurations"})," (tab) \u2192 ",(0,r.jsx)(n.strong,{children:"Base Configurations"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Deployment Template"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enable ",(0,r.jsx)(n.strong,{children:"Application Metrics"})," in the Deployment Template as shown below and save the changes."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/show-app-metrics.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 9: Enable Application Metrics"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Now, you can track all your application metrics by navigating to ",(0,r.jsx)(n.strong,{children:"Applications"})," and going to the ",(0,r.jsx)(n.strong,{children:"App Details"})," page of your Devtron App as shown below."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/app-new3.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 10: Application Metrics"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"caution",children:(0,r.jsxs)(n.p,{children:["If your environment is ",(0,r.jsx)(n.a,{href:"/docs/user-guide/creating-application/environment-overrides",children:"Overridden"}),", you need to enable the Application Metrics at the environment override deployment template instead of the base deployment template."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"troubleshoot-issues",children:"Troubleshoot Issues"}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)("strong",{children:"Facing Prometheus Deployment Timeout due to Failed CRDs"})}),(0,r.jsxs)(n.p,{children:["While deploying ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," chart, the deployment status may show as ",(0,r.jsx)(n.strong,{children:"Timed out"}),", and some CustomResourceDefinitions (CRDs) may appear as ",(0,r.jsx)(n.strong,{children:"Failed"}),"."]}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/app-metrics-deployment-timed-out-v2.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 11a: Deployment Timed Out"})]}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/app-management/devtron-apps/app-details/app-metrics/app-metrics-crds-failed.jpg",alt:""}),"\r\n",(0,r.jsx)("center",{children:"Figure 11b: CRDs Failed"})]}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"This behavior is expected and do not require any action from you."})}),(0,r.jsx)(n.p,{children:"This occurs because certain Prometheus CRDs are large in size, which can lead to temporary sync issues during deployment, but, this does not impact the functionality of the Prometheus components."}),(0,r.jsxs)(n.p,{children:["ArgoCD handles such cases automatically and the ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," will continue to function as expected."]})]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)("strong",{children:"Not able to see deployment metrics on production environment or Not able to enable application-metrics"})}),(0,r.jsx)(n.p,{children:"Update the rollout CRDs to the latest version, run the following command:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/devtron-labs/devtron/main/manifests/yamls/rollout.yaml -n devtroncd\n"})})]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)("strong",{children:" Grafana dashboards not visible in App Details page even after adding prometheus endpoint or Graphs showing error panel with id 2 not found"})}),(0,r.jsxs)(n.p,{children:["If the graphs are not visible check if Prometheus is configured properly. Then go to ",(0,r.jsx)(n.strong,{children:"Global Configurations"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Clusters & Environments"})," \u2192 Click on any environment for the cluster where you added Prometheus endpoint and simply click ",(0,r.jsx)(n.code,{children:"Update"}),".",(0,r.jsx)(n.br,{}),"\n","If the charts are still not visible, try visiting the URL: ",(0,r.jsx)(n.code,{children:"<devtron-url>/grafana?orgId=2"}),(0,r.jsx)(n.br,{}),"\n","If you see ",(0,r.jsx)(n.code,{children:"Not Found"})," on this page, then follow all the given steps or if the page is accessible, and you are getting ",(0,r.jsx)(n.code,{children:"panel with id 2 not found"})," then follow from step 6:"]}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Get Grafana password using ",(0,r.jsx)(n.code,{children:"kubectl -n devtroncd get secret devtron-secret -o jsonpath='{.data.GRAFANA_PASSWORD}' | base64 -d"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"kubectl run --rm -it --image quay.io/devtron/k8s-utils:tutum-curl curl"})," Run this command, and it will create a pod for using ",(0,r.jsx)(n.code,{children:"curl"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Copy the following and change ",(0,r.jsx)(n.code,{children:"grafana-password"})," with your password of Grafana and change the value of ",(0,r.jsx)(n.code,{children:"prometheusUrl"})," with your Prometheus endpoint, and run in the pod that we created above in step 2."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'cat << EOF\r\ngrafanaUrl="http://admin:grafana-password@devtron-grafana.devtroncd/grafana"\r\nprometheusUrl="http://prometheus.example.com"\r\n\r\nORG_ID=$( curl -d \'{"name":"devtron-metrics-view"}\' -H "Content-Type: application/json" -X POST "${grafanaUrl}/api/orgs" )\r\n\r\necho $ORG_ID\r\n\r\ncurl -X POST "${grafanaUrl}/api/user/using/2";\r\n\r\ncurl -X PUT -H "Content-Type: application/json" -d \'{"homeDashboardId":0,"theme":"light","timezone":"browser"}\' "${grafanaUrl}/api/org/preferences";\r\n\r\ncurl "${grafanaUrl}/api/datasources" -H \'content-type: application/json\' -H \'x-grafana-org-id: 2\' --data \'{"name":"Prometheus-devtron-demo","type":"prometheus","access":"proxy","isDefault":true}\'\r\n\r\ncurl "${grafanaUrl}/api/datasources/2" -X PUT \\\r\n    -H \'content-type: application/json\' \\\r\n    -H \'x-grafana-org-id: 2\' \\\r\n    --data \'{"id": 2 ,\r\n    "orgId": 2,\r\n    "name":"Prometheus-devtron-demo","type":"prometheus","access":"proxy",\r\n    "url":${prometheusUrl},\r\n    "basicAuth":false,"jsonData":{},"version":1}\'\r\nEOF\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Now visit ",(0,r.jsx)(n.code,{children:"<devtron-url>/grafana?orgId=2"})," again, and you'll see Grafana login page. Login using username ",(0,r.jsx)(n.code,{children:"admin"})," and password from step 1 and check if Prometheus URL is updated in data sources. If not, update it in the default data source."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Now from Devtron UI, update any of the environment again and its data source will be created automatically."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In Grafana UI you need to be logged in and Go to Dashboards \u2192 Manage then click ",(0,r.jsx)(n.code,{children:"Import"})," and Import the given dashboards one by one."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://grafana.com/api/dashboards/13322/revisions/4/download\r\nhttps://grafana.com/api/dashboards/13320/revisions/4/download\r\nhttps://grafana.com/api/dashboards/13325/revisions/4/download\r\nhttps://grafana.com/api/dashboards/13321/revisions/6/download\n"})}),"\n"]}),"\n"]}),(0,r.jsx)(n.p,{children:"After that, your issue should be resolved, and you should be able to see all the graphs on UI."})]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)("strong",{children:"If CPU metrics are not showing but memory metrics are visible in graphs."})}),(0,r.jsx)(n.p,{children:"Do the following:-"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Go to Grafana and Login with the credentials."}),"\n",(0,r.jsxs)(n.li,{children:["Edit the CPU graphs and remove ",(0,r.jsx)(n.code,{children:"image!=\u201d\u201d"})," from the query."]}),"\n",(0,r.jsx)(n.li,{children:"Save the dashboard."}),"\n"]}),(0,r.jsx)(n.p,{children:"CPU metrics should start showing up in a while."})]}),"\n",(0,r.jsxs)(s,{children:[(0,r.jsx)("summary",{children:(0,r.jsx)("strong",{children:"When app metrics is not coming on grafana and devtron dashboard, set the value of the following parameter as false in kube prometheus stack values."})}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"serviceMonitorSelectorNilUsesHelmValues: false\n"})})]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);