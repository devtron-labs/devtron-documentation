"use strict";(globalThis.webpackChunkdocdevtron=globalThis.webpackChunkdocdevtron||[]).push([[50029],{11470:(e,n,s)=>{s.d(n,{A:()=>S});var t=s(96540),r=s(34164),i=s(17559),o=s(23104),a=s(56347),l=s(205),c=s(57485),d=s(31682),u=s(70679);function h(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:s}=e;return(0,t.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:s,default:t}})=>({value:e,label:n,attributes:s,default:t}))}(s);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}function x({value:e,tabValues:n}){return n.some(n=>n.value===e)}function m({queryString:e=!1,groupId:n}){const s=(0,a.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(r),(0,t.useCallback)(e=>{if(!r)return;const n=new URLSearchParams(s.location.search);n.set(r,e),s.replace({...s.location,search:n.toString()})},[r,s])]}function j(e){const{defaultValue:n,queryString:s=!1,groupId:r}=e,i=p(e),[o,a]=(0,t.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find(e=>e.default)??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:i})),[c,d]=m({queryString:s,groupId:r}),[h,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,r]=(0,u.Dv)(n);return[s,(0,t.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:r}),f=(()=>{const e=c??h;return x({value:e,tabValues:i})?e:null})();(0,l.A)(()=>{f&&a(f)},[f]);return{selectedValue:o,selectValue:(0,t.useCallback)(e=>{if(!x({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),d(e),j(e)},[d,j,i]),tabValues:i}}var f=s(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=s(74848);function v({className:e,block:n,selectedValue:s,selectValue:t,tabValues:i}){const a=[],{blockElementScrollPositionUntilNextRender:l}=(0,o.a_)(),c=e=>{const n=e.currentTarget,r=a.indexOf(n),o=i[r].value;o!==s&&(l(n),t(o))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const s=a.indexOf(e.currentTarget)+1;n=a[s]??a[0];break}case"ArrowLeft":{const s=a.indexOf(e.currentTarget)-1;n=a[s]??a[a.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:t})=>(0,b.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{a.push(e)},onKeyDown:d,onClick:c,...t,className:(0,r.A)("tabs__item",g.tabItem,t?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function y({lazy:e,children:n,selectedValue:s}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===s);return e?(0,t.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function w(e){const n=j(e);return(0,b.jsxs)("div",{className:(0,r.A)(i.G.tabs.container,"tabs-container",g.tabList),children:[(0,b.jsx)(v,{...n,...e}),(0,b.jsx)(y,{...n,...e})]})}function S(e){const n=(0,f.A)();return(0,b.jsx)(w,{...e,children:h(e.children)},String(n))}},19365:(e,n,s)=>{s.d(n,{A:()=>o});s(96540);var t=s(34164);const r={tabItem:"tabItem_Ymn6"};var i=s(74848);function o({children:e,hidden:n,className:s}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,t.A)(r.tabItem,s),hidden:n,children:e})}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var t=s(96540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}},79108:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"user-guide/finops/configurations","title":"Configurations","description":"The Configurations page lets you manage configurations for Cost Visibility in Devtron. You can:","source":"@site/docs/user-guide/finops/configurations.md","sourceDirName":"user-guide/finops","slug":"/user-guide/finops/configurations","permalink":"/docs/user-guide/finops/configurations","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Cost Breakdown","permalink":"/docs/user-guide/finops/cost-breakdown"},"next":{"title":"Overview","permalink":"/docs/user-guide/security-features"}}');var r=s(74848),i=s(28453),o=s(11470),a=s(19365);const l={},c="Configurations",d={},u=[{value:"Currency (Default)",id:"currency-default",level:2},{value:"Enable Cost Tracking",id:"enable-cost-tracking",level:2},{value:"Step 1: Creating Custom Role",id:"step-1-creating-custom-role",level:4},{value:"Step 2: Create a Service Principal",id:"step-2-create-a-service-principal",level:4},{value:"Step 3: Enter Details in Devtron",id:"step-3-enter-details-in-devtron",level:4},{value:"Step 1: Set up a Spot Instance Data Feed",id:"step-1-set-up-a-spot-instance-data-feed",level:4},{value:"Step 2: Create an IAM Role or Use Access Keys",id:"step-2-create-an-iam-role-or-use-access-keys",level:4},{value:"IAM Role (Recommended)",id:"iam-role-recommended",level:4},{value:"Access Keys (Alternative)",id:"access-keys-alternative",level:4},{value:"Step 3: Configure in Devtron",id:"step-3-configure-in-devtron",level:4},{value:"Fetching Prometheus Endpoint",id:"fetching-prometheus-endpoint",level:2},{value:"Installing Prometheus",id:"installing-prometheus",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configurations",children:"Configurations"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"Configurations"})," page lets you manage configurations for Cost Visibility in Devtron. You can:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Set the default currency for all cost-related data."}),"\n",(0,r.jsx)(n.li,{children:"Enable or disable cost tracking for your connected clusters."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"currency-default",children:"Currency (Default)"}),"\n",(0,r.jsx)(n.p,{children:"You can select your preferred currency as default."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"enable-cost-tracking",children:"Enable Cost Tracking"}),"\n",(0,r.jsx)(n.p,{children:"To enable cost visibility for a cluster, follow the below steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Choose your preferred cluster, and click on ",(0,r.jsx)(n.strong,{children:"Off/Enabled"}),". An ",(0,r.jsx)(n.strong,{children:"Edit Cluster"})," modal window will open."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enable the toggle next to ",(0,r.jsx)(n.strong,{children:"Enable cost tracking"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Select the cloud provider in which you have created your cluster."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Based on the cloud provider you need to do the following configurations:"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(o.A,{children:[(0,r.jsxs)(a.A,{label:"GCP",value:"GCP",children:[(0,r.jsx)(n.p,{children:"To enable cost visibility for Google Cloud in Devtron, you need to generate an API key and use it to connect Devtron with your GCP account."}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Generate the API key using standard ",(0,r.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/api-keys#gcloud",children:"Google Cloud API key documentation"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Now go back to the ",(0,r.jsx)(n.strong,{children:"Edit cluster"})," modal window, and enter the API key in the ",(0,r.jsx)(n.strong,{children:"Cloud Provider API Key"})," field."]}),"\n"]}),"\n"]}),(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsxs)(n.p,{children:["If you face any issues while enabling or configuring the ",(0,r.jsx)(n.strong,{children:"Cost Visibility"})," module, reach out to ",(0,r.jsx)(n.a,{href:"mailto:enterprise@devtron.ai",children:"Devtron Support Team"})," for assistance."]})]})]}),(0,r.jsxs)(a.A,{label:"Azure",value:"Azure",children:[(0,r.jsx)(n.p,{children:"To enable cost visibility for your Azure clusters in Devtron, you need to allow Devtron to access your billing data securely. This requires two steps:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Create a custom role in Azure with billing access."}),"\n",(0,r.jsx)(n.li,{children:"Create a service principal (an identity) that Devtron can use to fetch cost details."}),"\n"]}),(0,r.jsx)(n.h4,{id:"step-1-creating-custom-role",children:"Step 1: Creating Custom Role"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Open a text editor and copy the following JSON:"}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Name": "OpenCostRole",\n  "IsCustom": true,\n  "Description": "Rate Card query role",\n  "Actions": [\n      "Microsoft.Compute/virtualMachines/vmSizes/read",\n      "Microsoft.Resources/subscriptions/locations/read",\n      "Microsoft.Resources/providers/read",\n      "Microsoft.ContainerService/containerServices/read",\n      "Microsoft.Commerce/RateCard/read"\n  ],\n  "AssignableScopes": [\n      "/subscriptions/YOUR_SUBSCRIPTION_ID"\n  ]\n}\n'})}),(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:"YOUR_SUBSCRIPTION_ID"})," with your actual subscription ID."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Save the file as ",(0,r.jsx)(n.code,{children:"myrole.json"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run the following command in your terminal:"}),"\n"]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"az role definition create --verbose --role-definition @myrole.json\n"})}),(0,r.jsxs)(n.p,{children:["This creates a role called ",(0,r.jsx)(n.code,{children:"OpenCostRole"})," with just enough access to read pricing information."]}),(0,r.jsx)(n.h4,{id:"step-2-create-a-service-principal",children:"Step 2: Create a Service Principal"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Run the command below, again replacing ",(0,r.jsx)(n.code,{children:"YOUR_SUBSCRIPTION_ID"})," with your subscription ID:"]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'az ad sp create-for-rbac \\\n  --name "OpenCostAccess" \\\n  --role "OpenCostRole" \\\n  --scope "/subscriptions/YOUR_SUBSCRIPTION_ID" \\\n  --output json\n'})}),(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"You\u2019ll get an output like this:"}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n   "appId": "1d9b1532-abe4-4e08-b172-adfa5384da1",\n   "displayName": "OpenCostAccess",\n   "password": "3XxxxxxxxxxxxxxxxxxxX3",\n   "tenant": "aee9b2ed-7ecc-4cb2-bfed-60d71c0e957"\n}\n'})}),(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Note this information as you need to enter this in Devtron."}),"\n"]}),(0,r.jsx)(n.h4,{id:"step-3-enter-details-in-devtron",children:"Step 3: Enter Details in Devtron"}),(0,r.jsxs)(n.p,{children:["Now go back to the ",(0,r.jsx)(n.strong,{children:"Edit cluster"})," modal window, and fill the following fields:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscription ID"})," - Your Azure subscription ID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"App ID"})," - Value of ",(0,r.jsx)(n.code,{children:"appId"})," from the output"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Display Name"})," - Value of ",(0,r.jsx)(n.code,{children:"displayName"})," from the output"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Password"})," - Value of ",(0,r.jsx)(n.code,{children:"password"})," from the output"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tenant"})," - Value of ",(0,r.jsx)(n.code,{children:"tenant"})," from the output"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Billing Account"})," - Optional (fill if available)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Offer ID"})," - Optional (fill if available)"]}),"\n"]}),(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsxs)(n.p,{children:["If you face any issues while enabling or configuring the ",(0,r.jsx)(n.strong,{children:"Cost Visibility"})," module, reach out to ",(0,r.jsx)(n.a,{href:"mailto:enterprise@devtron.ai",children:"Devtron Support Team"})," for assistance."]})]})]}),(0,r.jsxs)(a.A,{label:"AWS",value:"AWS",children:[(0,r.jsx)(n.p,{children:"If you have spot node instances in your AWS cluster, then only you need to do the below additional configurations for your AWS cluster, else you can skip the below configurations"}),(0,r.jsx)(n.h4,{id:"step-1-set-up-a-spot-instance-data-feed",children:"Step 1: Set up a Spot Instance Data Feed"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create an S3 bucket"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Assign full access permissions to the AWS Spot Data Feed service"}),"\n"]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Principal": {\n        "Service": "spot.amazonaws.com"\n      },\n      "Action": "*",\n      "Resource": "arn:aws:s3:::devtron-spot-feed/*"\n    },\n    {\n      "Effect": "Allow",\n      "Principal": {\n        "Service": "spot.amazonaws.com"\n      },\n      "Action": "*",\n      "Resource": "arn:aws:s3:::devtron-spot-feed"\n    }\n  ]\n}\n'})}),(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Run the following command to subscribe to the data feed using the AWS CLI"}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws ec2 create-spot-datafeed-subscription \\\n  --bucket devtron-spot-feed --prefix cost\n"})}),(0,r.jsx)(n.admonition,{title:"Note",type:"warning",children:(0,r.jsx)(n.p,{children:"You can subscribe to the Spot Data Feed for only one S3 bucket at a time. Running the command again updates the feed to the latest bucket."})}),(0,r.jsx)(n.h4,{id:"step-2-create-an-iam-role-or-use-access-keys",children:"Step 2: Create an IAM Role or Use Access Keys"}),(0,r.jsx)(n.p,{children:"You can connect Devtron to AWS cost data using either of the following methods:"}),(0,r.jsx)(n.h4,{id:"iam-role-recommended",children:"IAM Role (Recommended)"}),(0,r.jsx)(n.p,{children:"Create a Web Identity IAM role for your EKS/EC2 cluster with permissions to access the Spot Data Feed bucket. Attach the following policy (replace CHANGE-ME with your bucket name)"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Action": [\n        "s3:ListAllMyBuckets",\n        "s3:ListBucket",\n        "s3:Get*"\n      ],\n      "Resource": [\n        "arn:aws:s3:::CHANGE-ME",\n        "arn:aws:s3:::CHANGE-ME/*"\n      ],\n      "Effect": "Allow"\n    }\n  ]\n}\n\n'})}),(0,r.jsx)(n.h4,{id:"access-keys-alternative",children:"Access Keys (Alternative)"}),(0,r.jsxs)(n.p,{children:["Provide an Access Key and Secret Key with permissions ",(0,r.jsx)(n.code,{children:"s3:ListBucket"})," and ",(0,r.jsx)(n.code,{children:"s3:GetObject"})," for the Spot Data Feed bucket."]}),(0,r.jsx)(n.h4,{id:"step-3-configure-in-devtron",children:"Step 3: Configure in Devtron"}),(0,r.jsxs)(n.p,{children:["Now go back to the ",(0,r.jsx)(n.strong,{children:"Edit cluster"})," modal window, and fill the following fields:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spot Data Bucket"})," - Name of the S3 bucket storing Spot Instance Data Feed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spot Data Region"})," - AWS region of the Spot Data Feed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spot Data Prefix"})," - Prefix (if any) used for the Spot Data Feed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Project ID"})," - Your AWS Account ID"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access Key"})," - (Optional) AWS Access Key with S3 read permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Secret Access Key"})," - (Optional) AWS Secret Access Key with S3 read permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"IAM Role"})," - (Recommended) IAM role ARN assigned to the EKS/EC2 cluster for bucket access"]}),"\n"]})]})]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:["Enter Prometheus endpoint of your cluster. Refer ",(0,r.jsx)(n.a,{href:"#fetching-prometheus-endpoint",children:"Fetching Prometheus Endpoint"})," to learn more."]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsx)(n.p,{children:"Prometheus endpoint should be publicly exposed for the cost visibility to work."})]}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Save"}),", cost visibility will be enabled for the cluster."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"info",children:(0,r.jsx)(n.p,{children:"After enabling cost visibility, you will see your cluster information after 1 hour in cost visibility module."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"fetching-prometheus-endpoint",children:"Fetching Prometheus Endpoint"}),"\n",(0,r.jsx)(n.admonition,{title:"Note",type:"warning",children:(0,r.jsxs)(n.p,{children:["Ensure ",(0,r.jsx)(n.a,{href:"/docs/user-guide/app-management/configurations/gitops",children:"GitOps"})," is configured before deploying Prometheus. If not, Prometheus will default to being deployed via Helm."]})}),"\n",(0,r.jsx)(n.h3,{id:"installing-prometheus",children:"Installing Prometheus"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to the ",(0,r.jsx)(n.strong,{children:"Chart Store"})," and search for ",(0,r.jsx)(n.code,{children:"prometheus"}),". Use the Prometheus community's ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," chart to deploy Prometheus."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app2.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 1: Chart Store"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"After selecting the chart, configure these values as needed before deployment."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"kube-state-metrics: \n    metricLabelsAllowlist:   \n    - pods=[*]\n"})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"serviceMonitorSelectorNilUsesHelmValues: false\npodMonitorSelectorNilUsesHelmValues: false\n"})}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.p,{children:"Search for the above parameters, and update them as shown (or customize as needed)."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app3.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 2a: Prometheus Chart Configuration"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app-metrics-config.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 2b: Prometheus Chart Configuration (cont.)"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enable ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter to install CRDs:"]}),"\n",(0,r.jsxs)(n.p,{children:["Since Helm does not automatically apply CRDs, you need to enable the ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter in the Helm chart to ensure CRDs are applied before deploying Prometheus."]}),"\n",(0,r.jsxs)(n.p,{children:["In the Prometheus Helm chart settings, locate the ",(0,r.jsx)(n.code,{children:"upgradeJob"})," parameter and set it to ",(0,r.jsx)(n.code,{children:"true"})," if it is ",(0,r.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app-new2.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 3: upgradeJob Parameter"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["After enabling the parameter, click ",(0,r.jsx)(n.strong,{children:"Deploy Chart"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["While deploying ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," chart, the deployment status may show as ",(0,r.jsx)(n.strong,{children:"Timed out"}),", and some CustomResourceDefinitions (CRDs) may appear as ",(0,r.jsx)(n.strong,{children:"Failed"}),". This behavior is expected and does not require any action from you."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app-metrics-deployment-timed-out-v2.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 4a: Deployment Timed Out"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/creating-application/app-metrics/app-metrics-crds-failed.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 4b: CRDs Failed"})]}),"\n",(0,r.jsx)(n.p,{children:"This occurs because certain Prometheus CRDs are large in size, which can lead to temporary sync issues during deployment, but, this does not impact the functionality of the Prometheus components."}),"\n",(0,r.jsxs)(n.p,{children:["ArgoCD handles such cases automatically and the ",(0,r.jsx)(n.code,{children:"kube-prometheus-stack"})," will continue to function as expected."]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"After the chart is deployed successfully, you need to expose the Prometheus endpoint publicly."}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.mdxAdmonitionTitle,{}),(0,r.jsxs)(n.p,{children:["If you face any issues while enabling or configuring the ",(0,r.jsx)(n.strong,{children:"Cost Visibility"})," module, please contact the ",(0,r.jsx)(n.a,{href:"mailto:enterprise@devtron.ai",children:"Devtron Support Team"})," for assistance."]})]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);