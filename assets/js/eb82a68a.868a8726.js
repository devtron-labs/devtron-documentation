"use strict";(globalThis.webpackChunkdocdevtron=globalThis.webpackChunkdocdevtron||[]).push([[75404],{28453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>a});var t=o(96540);const r={},s=t.createContext(r);function i(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(s.Provider,{value:n},e.children)}},77739:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"user-guide/ai-recommendations/runbook","title":"Runbooks","description":"Introduction","source":"@site/docs/user-guide/ai-recommendations/runbook.md","sourceDirName":"user-guide/ai-recommendations","slug":"/user-guide/ai-recommendations/runbook","permalink":"/docs/user-guide/ai-recommendations/runbook","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Notifications","permalink":"/docs/user-guide/ai-recommendations/notifications"},"next":{"title":"Global Configurations","permalink":"/docs/user-guide/global-configurations/"}}');var r=o(74848),s=o(28453);const i={},a="Runbooks",c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Using AI-generated Runbooks",id:"using-ai-generated-runbooks",level:3},{value:"Using Your Runbook",id:"using-your-runbook",level:3},{value:"Add Runbook Spec",id:"add-runbook-spec",level:2},{value:"Example 1: Get Deployment Manifest",id:"example-1-get-deployment-manifest",level:3},{value:"Example 2: Update Resource Spec in Deployment Manifest",id:"example-2-update-resource-spec-in-deployment-manifest",level:3},{value:"Example 3: Update Resource Spec in Devtron Apps Config",id:"example-3-update-resource-spec-in-devtron-apps-config",level:3},{value:"Example 4: Update Resource Spec in Helm Chart Values",id:"example-4-update-resource-spec-in-helm-chart-values",level:3},{value:"Example 5: Webhook to Any Service",id:"example-5-webhook-to-any-service",level:3},{value:"Approval Types",id:"approval-types",level:2},{value:"Approve Options",id:"approve-options",level:3},{value:"Reject Options",id:"reject-options",level:3},{value:"Audit Logs",id:"audit-logs",level:2}];function l(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"runbooks",children:"Runbooks"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)(n.a,{href:"/docs/user-guide/ai-recommendations/runbook",children:"Runbook"})," is a predefined action that Devtron runs to apply a change, such as resizing resources or hibernating a namespace. When you approve an ",(0,r.jsx)(n.a,{href:"/docs/user-guide/ai-recommendations/notifications",children:"AI recommendation"}),", its linked runbook carries out the change with the required approvals."]}),"\n",(0,r.jsx)(n.h3,{id:"using-ai-generated-runbooks",children:"Using AI-generated Runbooks"}),"\n",(0,r.jsxs)(n.p,{children:["Whenever AI detects an optimization opportunity, it automatically generates a corresponding runbook to carry out the recommended change once approved. These runbooks are auto-linked from ",(0,r.jsx)(n.a,{href:"/docs/user-guide/ai-recommendations/notifications",children:"Notifications"})," of ",(0,r.jsx)(n.strong,{children:"AI Recommendations"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/ai-recommendations/runbook-listing.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 1: Runbook Listing"})]}),"\n",(0,r.jsx)(n.admonition,{title:"Example of Remediation Action",type:"info",children:(0,r.jsxs)(n.p,{children:["When AI recommends a cost optimization such as reducing memory allocation, the linked runbook carries out that change.",(0,r.jsx)(n.br,{}),"\n","For example, scaling down a pod\u2019s memory limit from 6 Gi to 3 Gi across selected clusters."]})}),"\n",(0,r.jsx)(n.admonition,{title:"Next Steps",type:"tip",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#add-runbook-spec",children:"Verify/Edit Runbook Spec"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#approval-types",children:"Approve/Reject Runbook"})}),"\n"]})}),"\n",(0,r.jsx)(n.h3,{id:"using-your-runbook",children:"Using Your Runbook"}),"\n",(0,r.jsx)(n.p,{children:"If you wish to create or modify a runbook beyond what AI generates automatically, Devtron allows you to create one."}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Follow this section only if you wish to create a runbook different than the one generated by AI."})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["From the left navigation, go to ",(0,r.jsx)(n.strong,{children:"AI Recommendations"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Runbooks"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Create Runbook"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/ai-recommendations/create-runbook.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 2: Creating New Runbook"})]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Enter the following details:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name"})," - Example: ",(0,r.jsx)(n.code,{children:"update-resource-limits"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"})," - Example: Updates CPU and memory limits for workloads."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Create Runbook"})," to save."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Next Steps",type:"tip",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#add-runbook-spec",children:"Verify/Edit Runbook Spec"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#approval-types",children:"Approve/Reject Runbook"})}),"\n"]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"add-runbook-spec",children:"Add Runbook Spec"}),"\n",(0,r.jsx)(n.p,{children:"You can edit your runbooks here. Each runbook follows a YAML structure that defines its metadata, tags, and executable steps."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/ai-recommendations/edit-runbook-spec.jpg",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 3: Edit Runbook Spec"})]}),"\n",(0,r.jsx)(n.p,{children:"Use the YAML editor in Devtron to paste and modify this structure."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: devtron.ai/v1\nkind: Runbook\nmetadata:\n  name: <name of the runbook>\n  description: <description of the runbook, specifying its purpose and usage>\n  tags:\n    - <tag1 specifying category or type>\n    - <tag2 specifying purpose>\nspec:\n  steps:\n    - name: <name of the step>\n      action: <predefined action to be executed>\n      type : <type of action, devtron-action, kubernetes-action, custom-action>\n      parameters:\n        param1: <value for parameter 1>\n        param2: <value for parameter 2>\n      onFailure:\n        - nextStep: <name of the next step to execute on failure>\n"})}),"\n",(0,r.jsx)(n.p,{children:"Each step in runbook spec represents one operation that can interact with Kubernetes resources, Devtron apps, or external systems. Below are the most commonly used predefined actions supported by Devtron runbooks."}),"\n",(0,r.jsx)(n.h3,{id:"example-1-get-deployment-manifest",children:"Example 1: Get Deployment Manifest"}),"\n",(0,r.jsx)(n.p,{children:"Retrieves the manifest of a specified deployment in a Kubernetes cluster."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'spec:\n  steps:\n    - name: <name of the step>\n      action: get-k8s-workload-controller-manifest\n      type : kubectl-get\n      parameters:\n        clusterId: "{{.clusterId}}"\n        group: "{{.group}}"\n        version: "{{.version}}"\n        kind: "Deployment"\n        namespace: "{{.namespace}}"\n        resourceName: "{{.resourceName}}"\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"When to use",type:"tip",children:(0,r.jsx)(n.p,{children:"To inspect the configuration of an existing deployment before applying any changes."})}),"\n",(0,r.jsx)(n.h3,{id:"example-2-update-resource-spec-in-deployment-manifest",children:"Example 2: Update Resource Spec in Deployment Manifest"}),"\n",(0,r.jsx)(n.p,{children:"Updates the CPU and memory requests or limits for a container inside a Kubernetes workload."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'spec:\n  steps:\n    - name: <name of the step>\n      action: update-k8s-workload-resource-spec\n      type : kubectl-patch\n      parameters:\n        clusterId: "{{.clusterId}}"\n        group: "{{.group}}"\n        version: "{{.version}}"\n        kind: "Pod"\n        namespace: "{{.namespace}}"\n        resourceName: "{{.resourceName}}"\n        patch:\n          spec:\n            container:\n              name: "{{.containerName}}"\n              resources:\n                requests:\n                  cpu: "{{.newCpuRequestValue}}"\n                  memory: "{{.newMemoryRequestValue}}"\n                limits:\n                  cpu: "{{.newCpuLimitValue}}"\n                  memory: "{{.newMemoryLimitValue}}"\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"When to use",type:"tip",children:(0,r.jsx)(n.p,{children:"To rightsize workload resource consumption and optimize costs."})}),"\n",(0,r.jsx)(n.h3,{id:"example-3-update-resource-spec-in-devtron-apps-config",children:"Example 3: Update Resource Spec in Devtron Apps Config"}),"\n",(0,r.jsx)(n.p,{children:"Applies resource specification updates within Devtron-managed application configurations."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'spec:\n  steps:\n    - name: <name of the step>\n      action: update-resource-spec-devtron-apps-config\n      type : devtron-app-patch\n      parameters:\n        clusterId: "{{.clusterId}}"\n        group: "{{.group}}"\n        version: "{{.version}}"\n        kind: "Pod"\n        namespace: "{{.namespace}}"\n        resourceName: "{{.resourceName}}"\n        patch:\n          spec:\n            container:\n              name: "{{.containerName}}"\n              resources:\n                requests:\n                  cpu: "{{.newCpuRequestValue}}"\n                  memory: "{{.newMemoryRequestValue}}"\n                limits:\n                  cpu: "{{.newCpuLimitValue}}"\n                  memory: "{{.newMemoryLimitValue}}"\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"When to use",type:"tip",children:(0,r.jsx)(n.p,{children:"To modify resource values for Devtron-managed apps directly through the configuration interface."})}),"\n",(0,r.jsx)(n.h3,{id:"example-4-update-resource-spec-in-helm-chart-values",children:"Example 4: Update Resource Spec in Helm Chart Values"}),"\n",(0,r.jsx)(n.p,{children:"Modifies resource settings defined within Helm chart values YAML files."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'spec:\n  steps:\n    - name: <name of the step>\n      action: update-resource-spec-helm-chart-values-yaml\n      type : helm-chart-patch\n      parameters:\n        clusterId: "{{.clusterId}}"\n        group: "{{.group}}"\n        version: "{{.version}}"\n        kind: "Pod"\n        namespace: "{{.namespace}}"\n        resourceName: "{{.resourceName}}"\n        patch:\n          spec:\n            container:\n              name: "{{.containerName}}"\n              resources:\n                requests:\n                  cpu: "{{.newCpuRequestValue}}"\n                  memory: "{{.newMemoryRequestValue}}"\n                limits:\n                  cpu: "{{.newCpuLimitValue}}"\n                  memory: "{{.newMemoryLimitValue}}"\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"When to use",type:"tip",children:(0,r.jsx)(n.p,{children:"To synchronize Helm chart values with runtime resource adjustments."})}),"\n",(0,r.jsx)(n.h3,{id:"example-5-webhook-to-any-service",children:"Example 5: Webhook to Any Service"}),"\n",(0,r.jsx)(n.p,{children:"Sends a webhook to an external service for integrations such as Slack notifications, monitoring tools, or CI/CD triggers."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'spec:\n  steps:\n    - name: <name of the step>\n      action: webhook\n      type : devtron-action\n      parameters:\n        url: <<"url to which the webhook needs to be sent">>\n        headers: <<"headers to be included in the webhook">>\n        httpMethod: <<"HTTP method to be used (GET, POST, etc.)">>\n        body: <<"body of the webhook">>\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"When to use",type:"tip",children:(0,r.jsx)(n.p,{children:"To notify other systems or trigger automated workflows upon completion of a Devtron runbook."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"approval-types",children:"Approval Types"}),"\n",(0,r.jsx)(n.p,{children:"Before execution, every AI-generated runbook requires an approval decision. You can approve or reject its execution for specific clusters and different durations."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/ai-recommendations/runbook-approval.gif",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 4: Approve or Reject Runbook"})]}),"\n",(0,r.jsx)(n.p,{children:"When you take an action, Devtron applies the following logic:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If you approve or reject a runbook, the decision auto-applies to all the recommendations linked to that runbook across the selected clusters."}),"\n",(0,r.jsx)(n.li,{children:"If you approve or reject an individual recommendation, the runbook is rejected only for that specific cluster where the recommendation originated."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"approve-options",children:"Approve Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Behavior"}),(0,r.jsx)(n.th,{children:"Example Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Forever"})}),(0,r.jsx)(n.td,{children:"All future runs of this runbook stands indefinitely auto-approved."}),(0,r.jsx)(n.td,{children:"For dev or sandbox clusters where downtime or failed runs are acceptable and you want continuous savings."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Till date & time"})}),(0,r.jsx)(n.td,{children:"Auto-approves until a specific expiry date and time."}),(0,r.jsx)(n.td,{children:"During a maintenance window or before a critical demo, so changes are applied automatically until that period ends."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"For duration"})}),(0,r.jsx)(n.td,{children:"Auto-approves temporarily for a set number of hours."}),(0,r.jsx)(n.td,{children:"For short tests or limited-time fixes, such as approving remediation for the next few hours."})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"reject-options",children:"Reject Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Behavior"}),(0,r.jsx)(n.th,{children:"Example Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Forever"})}),(0,r.jsx)(n.td,{children:"Blocks all future runs of this runbook permanently."}),(0,r.jsx)(n.td,{children:"For production clusters where any automated remediation is risky or unwanted."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Till date & time"})}),(0,r.jsx)(n.td,{children:"Rejects runs until a specific expiry date and time."}),(0,r.jsx)(n.td,{children:"When you want the cluster to stay stable (e.g., during a product demo or release)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"For duration"})}),(0,r.jsx)(n.td,{children:"Rejects runs temporarily for a few hours."}),(0,r.jsx)(n.td,{children:"To pause remediation during high-traffic periods or while verifying manual changes."})]})]})]}),"\n",(0,r.jsx)(n.admonition,{title:"What happens when the approval or rejection period expires?",type:"note",children:(0,r.jsxs)(n.p,{children:["When any approval or rejection period ends, the runbook status resets to ",(0,r.jsx)(n.strong,{children:"Action Pending"}),". The user is expected to take an action again."]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"audit-logs",children:"Audit Logs"}),"\n",(0,r.jsx)(n.p,{children:"Every Runbook logs:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Created / Updated / Approved / Rejected actions"}),"\n",(0,r.jsx)(n.li,{children:"User, timestamp, and resource"}),"\n",(0,r.jsx)(n.li,{children:"Full JSON payload for traceability"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.img,{src:"https://devtron-public-asset.s3.us-east-2.amazonaws.com/images/devtron-v2/ai-recommendations/runbook-audit-log.gif",alt:""}),"\n",(0,r.jsx)("center",{children:"Figure 5: Audit Log"})]}),"\n",(0,r.jsxs)(n.p,{children:["You can access this under ",(0,r.jsx)(n.strong,{children:"AI Recommendations"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Runbooks"})," \u2192 ",(0,r.jsx)(n.strong,{children:"Audit Logs"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);